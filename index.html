<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pemilihan Presiden Mahasiswa</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  <style>
    body {
      box-sizing: border-box;
    }

    .preserve-newlines {
      white-space: pre-wrap;
    }

    .gradient-bg {
      background: linear-gradient(140deg, #1e3a8a 0%, #255267 100%);
    }

    p {
      color: rgb(255, 255, 255);
    }

    h1 {
      color: rgb(255, 255, 255);
    }

    .card-shadow {
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
    }

    .animate-fade-in {
      animation: fadeIn 0.5s ease-in;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(20px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .vote-card {
      transition: all 0.3s ease;
    }

    .vote-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 15px 35px rgba(0, 0, 0, 0.15);
    }

    .progress-bar {
      transition: width 0.5s ease-in-out;
    }

    /* Tambahan untuk spinner loading */
    .spinner {
      display: inline-block;
      width: 16px;
      height: 16px;
      border: 2px solid #ffffff;
      border-radius: 50%;
      border-top-color: transparent;
      animation: spin 1s ease-in-out infinite;
      margin-right: 8px;
    }

    .spinner.hidden {
      display: none;
    }

    @keyframes spin {
      to {
        transform: rotate(360deg);
      }
    }

    button:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }

    .edit-bg {
      background-color: rgba(255, 255, 255, 0.192);
      border: 2px solid #c7c7c7;
      border-radius: 10px;
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
      box-shadow: 0 0 30px rgba(0, 0, 0, 0.705);
    }

    .edit-bg1 {
      background-color: rgba(0, 0, 0, 0.192);
      border: 2px solid #c7c7c7;
      border-radius: 10px;
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
      box-shadow: 0 0 30px rgba(0, 0, 0, 0.705);
    }

    .wrep {
      position: relative;
      background-color: transparent;
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
      box-shadow: 0 0 30px rgba(0, 0, 0, 0.5);
    }

    .wrep .form-edit input {
      width: 100%;
      position: relative;
    }

    .wrep .form-edit .edit-input {
      position: relative;
      width: 100%;
      height: 50px;
      border-bottom: 2px solid #ffffff;
      margin: 30px 0;
    }

    .wrep .form-edit .edit-input label {
      position: absolute;
      top: 50%;
      left: 5px;
      transform: translateY(-50%);
      font-weight: 500;
      color: #000000;
      pointer-events: none;
    }

    .wrep .form-edit .edit-input input:focus~label,
    .wrep .form-edit .edit-input input:valid~label {
      transform: translateY(-50%);
      top: -10px;
      left: 0;
      color: #ffffff;
    }

    .form-edit .edit-input input {
      width: 100%;
      height: 100%;
      background-color: rgba(255, 255, 255, 0.082);
      border: none;
      outline: none;
      color: #ffffff;
      font-size: 1.1rem;
    }

    .form-edit .edit-input .icon {
      position: absolute;
      right: 10px;
      top: 50%;
      transform: translateY(-50%);
      color: #010101;
      font-size: 1.5rem;
      line-height: 57px;
    }

    .borrder {
      border: #ffffff 2px solid;
    }

    .borrder-tombol2 {
      background-color: #255267;
      color: #C9E1EB;
      border: #C9E1EB 1px solid;
      box-shadow: 0 0 5px rgba(0, 0, 0, 0.705);
    }

    .borrder-tombol2:hover {
      background-color: #c9e1eb70;
      border: transparent 1px solid;
      color: #0f222c;
    }
  </style>
</head>

<body class="gradient-bg min-h-screen">
  <!-- Login Form -->
  <div id="loginForm" class="wrep min-h-screen flex flex-col justify-center items-center p-4">
    <!-- Tambahkan justify-center items-center -->
    <div class="text-center mb-10 mt-4">
      <div class="">
        <h1 class="text-3xl font-bold text-black-800">Peringatan !!</h1>
        <h1 class="text-lg font-semibold text-black-800"> Voting hanya bisa dilakukan 1x, pastikan anda tidak salah
          memilih.</h1>
      </div>
    </div>
    <div class="edit-bg items-center form-edit rounded-2xl card-shadow p-6 w-full max-w-md animate-fade-in">
      <div class="text-center mb-8">
        <p class="text-black-600">Masukkan data Anda untuk memulai voting</p>
      </div>

      <form id="voterForm" class=" space-y-6">
        <div class="edit-input">
          <span class="icon"><ion-icon name="mail-outline"></ion-icon></span>
          <input type="text" id="nama" required
            class="w-full text-sm font-medium text-black-300 px-4 py-3 border border-black-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
          <label for="nama" class=" text-sm font-medium text-black-700 mb-2">Nama Lengkap</label>
        </div>

        <div class="edit-input">
          <span class="icon"><ion-icon name="mail-outline"></ion-icon></span>
          <input type="text" id="nim" required
            class="w-full text-sm font-medium text-black-300 px-4 py-3 border border-black-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
          <label for="nim" class="block text-sm font-medium text-black-700 mb-2">NIM</label>
        </div>

        <div class="edit-input">
          <span class="icon"><ion-icon name="lock-closed-outline"></ion-icon></span>
          <input type="password" id="password" required
            class="w-full text-sm font-medium text-black-300 px-4 py-3 border border-black-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
          <label for="password" class="block text-sm font-medium text-black-700 mb-2">Password</label>
        </div>

        <button type="submit" id="loginBtn"
          class="w-full borrder-tombol2 font-semibold py-3 px-6 rounded-lg transition-colors duration-200">
          <span class="spinner hidden"></span>
          Masuk ke Voting
        </button>
      </form>
    </div>
    <!-- Footer -->
    <footer class="mt-8 text-center text-white font-semibold py-4 text-sm opacity-60 sm:mt-auto md:mt-auto">
      <!-- Tambahkan mt-auto untuk push ke bawah -->
      Â© 2025. Dikembangkan oleh Panitia KPU-Samba.
    </footer>
  </div>

  <!-- Voting Page -->
  <div id="votingPage" class="min-h-screen hidden gradient-bg animate-fade-in">
    <!-- Header -->
    <header class="bg-[#01010138] shadow-md p-4 flex justify-between items-center">
      <span id="welcomeMessage" class="text-sm sm:text-lg md:text-xl text-center text-[#C9E1EB] font-semibold">Selamat
        datang <span id="userName">Loading...</span> Silahlan pilih kandidat</span>
      <div class="flex items-center space-x-4">
        <button id="logoutBtn"
          class="borrder-tombol2 px-2 py-1 sm:px-4 sm:py-2 md:px-4 md:py-2 rounded-lg transition-colors duration-200">Keluar</button>
      </div>
    </header>

    <!-- Main Content -->
    <main class="flex flex-col sm:flex-row min-h-[calc(80vh-80px)]">
      <!-- Panel Kiri: Profil Kandidat -->
      <div class="sm:w-1/3 p-2 sm:p-6 shadow-xl m-4 rounded-lg">
        <div id="candidateProfile" class="text-center">
          <!-- Skeleton Loader -->
          <div id="profileSkeleton" class="animate-pulse">
            <div class="w-32 h-32 bg-gray-300 rounded-full mx-auto mb-4"></div>
            <div class="h-6 bg-gray-300 rounded mb-2"></div>
            <div class="h-4 bg-gray-300 rounded mb-4"></div>
          </div>
          <!-- Actual Content -->
          <img id="candidatePhoto" src="" alt="Foto kandidat"
            class="edit-bg1 sm:w-64 sm:h-48 w-48 h-32 rounded-lg mx-auto mb-4 object-cover hidden" loading="lazy">
          <h2 id="candidateName" style="white-space: pre-wrap;" class="text-2xl font-bold text-white mb-2 hidden"></h2>
          <p id="candidateNumber" class="text-lg text-white mb-2 hidden">Paslon No, </p>
          <button id="selectCandidateBtn" onclick="showVoteConfirmation()"
            class="borrder-tombol2 px-6 py-3 rounded-lg font-semibold transition-colors duration-200 hidden">Pilih
            Kandidat</button>
        </div>
      </div>

      <!-- Panel Tengah: Visi & Misi -->
      <div class="sm:w-2/3 edit-bg1 p-6 shadow-lg m-4 rounded-lg flex-1">
        <div id="visionMissionContent" class="p-2 max-h-40 sm:max-h-80 overflow-y-auto">
          <!-- Skeleton Loader -->
          <div id="vmSkeleton" class="animate-pulse space-y-4">
            <div class="h-4 bg-gray-300 rounded"></div>
            <div class="h-4 bg-gray-300 rounded"></div>
            <div class="h-4 bg-gray-300 rounded"></div>
            <div class="h-4 bg-gray-300 rounded"></div>
            <div class="h-4 bg-gray-300 rounded"></div>
          </div>
          <!-- Actual Content -->
          <div id="visionMissionText" class="leading-relaxed hidden">
            <h3 class="text-3xl font-bold text-white mb-4">Visi</h3>
            <p id="visionText"></p>
            <h3 class="text-3xl font-bold text-white mb-4 mt-4">Misi</h3>
            <p id="missionText" class="mt-4 preserve-newlines" style="white-space: pre-wrap;"></p>
          </div>
        </div>
      </div>
    </main>

    <!-- Bar Bawah: Preview Kandidat Lain -->
    <div class="p-4 shadow-lg rounded-lg">
      <div id="candidateThumbnails" class="flex space-x-12 overflow-x-auto justify-center lg:justify-center">
        <!-- Thumbnails akan di-render oleh JS -->
      </div>
      <!-- <div id="kandidatList" class="hidden"></div> -->
    </div>
  </div>

  <!-- Vote Confirmation -->
  <div id="voteConfirmation" class="min-h-screen flex items-center justify-center p-4 hidden">
    <div class="bg-white rounded-2xl card-shadow p-8 w-full max-w-md animate-fade-in text-center">
      <div class="w-20 h-20 mx-auto mb-6 bg-green-100 rounded-full flex items-center justify-center">
        <svg class="w-10 h-10 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
        </svg>
      </div>

      <h2 class="text-2xl font-bold text-gray-800 mb-4">Suara Berhasil Disimpan!</h2>
      <p class="text-gray-600 mb-6">Terima kasih telah berpartisipasi dalam pemilihan presiden mahasiswa.</p>
      <p class="text-sm text-gray-500 mb-8">Anda telah memilih: <span id="selectedCandidate"
          class="font-semibold"></span></p>

      <!-- Tombol "Lihat Hasil Sementara" dihapus di sini -->

      <button onclick="logout()" id="logoutConfirmBtn"
        class="w-full borrder-tombol2 font-semibold py-3 px-6 rounded-lg transition-colors duration-200">
        <span class="spinner hidden"></span>
        Keluar
      </button>
    </div>
  </div>
  <!-- Tambah di akhir body, sebelum script -->
  <div id="toastContainer" class="fixed top-4 right-4 z-50 space-y-2"></div>

  <script src="script.js"></script>
  <!-- <script>(function () { function c() { var b = a.contentDocument || a.contentWindow.document; if (b) { var d = b.createElement('script'); d.innerHTML = "window.__CF$cv$params={r:'98faf6674423aa11',t:'MTc2MDY1MzQyNi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);"; b.getElementsByTagName('head')[0].appendChild(d) } } if (document.body) { var a = document.createElement('iframe'); a.height = 1; a.width = 1; a.style.position = 'absolute'; a.style.top = 0; a.style.left = 0; a.style.border = 'none'; a.style.visibility = 'hidden'; document.body.appendChild(a); if ('loading' !== document.readyState) c(); else if (window.addEventListener) document.addEventListener('DOMContentLoaded', c); else { var e = document.onreadystatechange || function () { }; document.onreadystatechange = function (b) { e(b); 'loading' !== document.readyState && (document.onreadystatechange = e, c()) } } } })();</script> -->
  <script>    
  function redirectCU(e) {
    if (e.ctrlKey && e.which == 85) {
      window.location.replace("403.html");
      return false;
    }
  }
  document.onkeydown = redirectCU;

  //Script Redirect Klik Kanan
  function redirectKK(e) {
    if (e.which == 3) {
      window.location.replace("403.html");
      return false;
    }
  }
  document.oncontextmenu = redirectKK;
  //]]></script>
  <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
  <script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>

</body>

</html>
